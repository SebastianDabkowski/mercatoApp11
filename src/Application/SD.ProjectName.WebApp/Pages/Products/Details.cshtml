@page "/Products/Details/{id:int}"
@model SD.ProjectName.WebApp.Pages.Products.DetailsModel
@{
    ViewData["Title"] = Model.Product?.Title ?? "Product unavailable";
}

@if (Model.Product == null)
{
    <div class="alert alert-warning" role="alert">
        @Model.StatusMessage ?? "This product is unavailable."
    </div>
}
else
{
    <h1>@Model.Product.Title</h1>
    @if (!string.IsNullOrWhiteSpace(Model.Product.MainImageUrl))
    {
        <div class="mb-3">
            <img src="@Model.Product.MainImageUrl" alt="Main image for @Model.Product.Title" class="img-fluid rounded" />
        </div>
    }
    <dl class="row">
        <dt class="col-sm-2">Price</dt>
        <dd class="col-sm-10">@Model.Product.Price.ToString("C")</dd>
        <dt class="col-sm-2">Category</dt>
        <dd class="col-sm-10">@Model.Product.Category</dd>
        <dt class="col-sm-2">Stock</dt>
        <dd class="col-sm-10">@Model.Product.Stock</dd>
        @if (!string.IsNullOrWhiteSpace(Model.Product.Description))
        {
            <dt class="col-sm-2">Description</dt>
            <dd class="col-sm-10">@Model.Product.Description</dd>
        }
        @if (!string.IsNullOrWhiteSpace(Model.Product.ShippingMethods))
        {
            <dt class="col-sm-2">Shipping</dt>
            <dd class="col-sm-10">@Model.Product.ShippingMethods</dd>
        }
        @if (Model.Product.WeightKg.HasValue || Model.Product.LengthCm.HasValue || Model.Product.WidthCm.HasValue || Model.Product.HeightCm.HasValue)
        {
            <dt class="col-sm-2">Package</dt>
            <dd class="col-sm-10">
                <div>Weight: @(Model.Product.WeightKg?.ToString("0.###") ?? "n/a") kg</div>
                <div>Dimensions: @(Model.Product.LengthCm?.ToString("0.###") ?? "n/a") x @(Model.Product.WidthCm?.ToString("0.###") ?? "n/a") x @(Model.Product.HeightCm?.ToString("0.###") ?? "n/a") cm</div>
            </dd>
        }
        @if (!string.IsNullOrWhiteSpace(Model.Product.GalleryImageUrls))
        {
            var galleryImages = Model.Product.GalleryImageUrls
                .Split(',', StringSplitOptions.RemoveEmptyEntries | StringSplitOptions.TrimEntries)
                .ToList();
            if (galleryImages.Any())
            {
                <dt class="col-sm-2">Gallery</dt>
                <dd class="col-sm-10 d-flex flex-wrap gap-2">
                    @foreach (var image in galleryImages)
                    {
                        <img src="@image" alt="Gallery image for @Model.Product.Title" class="img-thumbnail" style="max-width: 120px;" />
                    }
                </dd>
            }
        }
    </dl>
}
